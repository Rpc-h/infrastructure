- name: Restart entry Nodes
  gather_facts: false
  hosts: entry_node_a,entry_node_b,entry_node_c,exit_node_a,exit_node_b,exit_node_c
  become: true
  vars:
    clean_db: false
  tasks:
    - name: Stop Hoprd service
      ansible.builtin.service:
        name: "hoprd.service"
        state: stopped
        enabled: true

    - name: Remove database
      ansible.builtin.shell:
        cmd: rm -rf /opt/hoprd/db
      when: clean_db == 'true'

    - name: Start Hoprd service
      ansible.builtin.service:
        name: "hoprd.service"
        state: started
        enabled: true

- name: Restart exit Nodes
  gather_facts: false
  hosts: exit_node_a,exit_node_b,exit_node_c
  become: true
  tasks:
    - name: Restart Exit Node service
      ansible.builtin.service:
        name: "exit-node.service"
        state: restarted
        enabled: true


